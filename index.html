<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart.js 기본 테스트</title>
    <style>
        /* 아주 기본적인 스타일 */
        body { display: flex; justify-content: center; align-items: center; min-height: 90vh; margin: 0; font-family: sans-serif; background-color: #f0f0f0; }
        .chart-container { width: 80%; max-width: 600px; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-moment/1.0.1/chartjs-adapter-moment.min.js" defer></script>
    </head>
<body>
    <div class="chart-container">
        <canvas id="mySimpleChart"></canvas>
    </div>

    <script>
        // Chart.js 라이브러리가 로드될 때까지 기다리는 함수
        function ensureBasicChartJsReady(callback) {
            if (typeof window.Chart !== 'undefined' && typeof window.moment !== 'undefined' && typeof Chart.register === 'function') {
                console.log("기본 테스트: Chart.js와 Moment.js가 준비되었습니다.");
                callback();
            } else {
                console.warn("기본 테스트: Chart.js 또는 Moment.js가 아직 준비되지 않았습니다. 200ms 후 재시도합니다...");
                setTimeout(() => ensureBasicChartJsReady(callback), 200);
            }
        }

        // window.onload는 모든 리소스(외부 스크립트 포함) 로드 후 실행
        window.onload = () => {
            ensureBasicChartJsReady(() => {
                const ctx = document.getElementById('mySimpleChart');
                if (!ctx) {
                    console.error("기본 테스트: #mySimpleChart 캔버스 요소를 찾을 수 없습니다!");
                    return;
                }

                try {
                    console.log("기본 테스트: 차트 생성을 시도합니다...");
                    const myChart = new Chart(ctx, {
                        type: 'bar', // 간단한 바 차트
                        data: {
                            labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                            datasets: [{
                                label: '# of Votes',
                                data: [12, 19, 3, 5, 2, 3],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                    'rgba(75, 192, 192, 0.2)',
                                    'rgba(153, 102, 255, 0.2)',
                                    'rgba(255, 159, 64, 0.2)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            },
                            responsive: true,
                            maintainAspectRatio: true // 컨테이너 비율 유지 (false로 하면 height가 적용됨)
                        }
                    });
                    console.log("기본 테스트: 차트 객체가 성공적으로 생성되었습니다!", myChart);
                    // 성공 메시지를 화면에도 표시 (선택적)
                    const container = document.querySelector('.chart-container');
                    const successMsg = document.createElement('p');
                    successMsg.textContent = 'Chart.js 기본 바 차트가 성공적으로 로드되었습니다!';
                    successMsg.style.textAlign = 'center';
                    successMsg.style.color = 'green';
                    container.appendChild(successMsg);

                } catch (e) {
                    console.error("기본 테스트: Chart.js 차트 생성 중 예외 발생:", e);
                    const container = document.querySelector('.chart-container');
                    const errorMsg = document.createElement('p');
                    errorMsg.textContent = 'Chart.js 차트 생성 중 오류 발생. 콘솔을 확인하세요.';
                    errorMsg.style.textAlign = 'center';
                    errorMsg.style.color = 'red';
                    container.appendChild(errorMsg);
                }
            });
        };
    </script>
</body>
</html>
